---
title: "Power Analysis"
output: html_notebook
---

I performed power analysis for my dissertation project (Studies 2 and 3). Study 1 did not have a power analysis since I used pre-existing datasets.

```{r}
library(pwr)
library(psych) # fisherz2r
library(Superpower) # Simulation-based power analysis for Study 3
library(tidyverse)
safeguard_level <- .60
Richard_r <- .21
Richard_n_meta_analyes <- 474
Richard_n_studies <- 33912 # not used
Richard_z <- 0.5 * log((1 + Richard_r)/(1 - Richard_r))
Richard_z_var <- 1 / (Richard_n_meta_analyes - 3)
Richard_z_SE <- sqrt(Richard_z_var) # Borenstein
qprop <-  1 - (1-safeguard_level)/2
Richard_z_UL <- Richard_z + qnorm(qprop) * Richard_z_SE
Richard_z_LL <- Richard_z - qnorm(qprop) * Richard_z_SE
Richard_z_LL_r <- fisherz2r(Richard_z_LL)
Richard_z_LL_d <- r2d(Richard_z_LL_r)
```


# Study 2
The aim of Study 2 is to test a hypothesis that recalling playing one's favoriate game will mitigate the effect of social rejection.  The study used a two-group design.

Since there was only one study tested this hypothesis, and relying one single-study for an effect size estimate is unreliable, I used an average effect size reported in social psychology literature. I took `r safeguard_level * 100`% confidence intervals. I will use the lower bound of this confidence interval as the target effect size.




```{r}
study2_power <- .90
study2_alpha <- .05
study2_pwr <- pwr.t.test(d = Richard_z_LL_d,
                         sig.level = study2_alpha,
                         power = study2_power)
```



The resulting target sample size with power = `r study2_power` and alpha = `r study2_alpha` is `r ceiling(study2_pwr$n)` per group (total N = `r ceiling(study2_pwr$n) * 2` for two groups)



# Study 3

In Study 3, I will test whether two factors, Parasocial Relationships and Social Worlds, can influence belonging in a 2 x 2 between-subjects design. Similar to Study 2, there were no reliable effect size estimates available, and thus I rely on the averge effect size reported by Richard et al. (2003).


Since parasocial relationships involve more direct interactions than social worlds, I expect that parasocial relationship more strongly affects belonging thana social words. Given this assumption, I expect the pattern of the results as follows: 

1. Participants who had parasocial interactions and immersed in social words report the highest belonging
2. Participants who had parasocial interactions without social worlds
3. Participats without parasocial interactions with social worlds
4. Participants did not have either parasocial interactions or social worlds will report the lowest belonging 

```{r}
study3_target_d <- Richard_z_LL_d
```



## ANOVA Power Power Analyis - per Lakens & Caldwell Method

```{r}
study3_design_pattern2 <- ANOVA_design(design = "2b*2b",
                              n = 172,
                              mu = c(0,
                                     study3_target_d,
                                     study3_target_d,
                                     study3_target_d * 2), sd = 1,
                              labelnames = c("Parasocial", "Low", "High",
                                             "SocialWorlds", "Low", "High"),
                              plot = TRUE)
study3_pattern2_results<- plot_power(study3_design_pattern2,
           min = 70,
           max = 100)

ANOVA_exact(study3_design_pattern2, alpha_level = 0.05)

```


```{r}
study3_design_pattern2$meansplot +
  ylab("Cohen's d") +
  xlab("Parasocial Relationships") +
  scale_color_discrete(name = "Social Worlds")
```


```{r}
study3_design_pattern3 <- ANOVA_design(design = "2b*2b",
                              n = 86,
                              mu = c(0,
                                     study3_target_d,
                                     study3_target_d,
                                     0), sd = 1,
                              labelnames = c("Parasocial", "Low", "High",
                                             "SocialWorlds", "Low", "High"),
                              plot = TRUE)
ANOVA_exact(study3_design_pattern3, alpha_level = 0.05)

```


```{r}

```

